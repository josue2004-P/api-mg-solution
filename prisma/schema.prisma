generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model usuarios {
  id                   BigInt           @id @default(autoincrement())
  nombre_usuario       String           @unique @db.VarChar(50)
  correo_electronico   String           @unique @db.VarChar(100)
  contrasena_hash      String           @db.VarChar(255)
  nombre               String?          @db.VarChar(50)
  apellido             String?          @db.VarChar(50)
  esta_activo          Boolean          @default(true)
  ultimo_inicio_sesion DateTime?
  creado_en            DateTime         @default(now()) @db.Timestamp(6)
  actualizado_en       DateTime         @db.Timestamp(6)

  usuario_perfil usuario_perfil[]
}

model perfiles {
  id             BigInt           @id @default(autoincrement())
  nombre         String           @unique @db.VarChar(50)
  descripcion    String?
  created_at     DateTime         @default(now()) @db.Timestamp(6)
  updated_at     DateTime         @db.Timestamp(6)

  usuario_perfil  usuario_perfil[]
  perfil_permisos perfil_permisos[]
}

model usuario_perfil {
  user_id   BigInt
  perfil_id BigInt

  usuarios usuarios @relation(fields: [user_id], references: [id], onDelete: Cascade)
  perfiles perfiles @relation(fields: [perfil_id], references: [id], onDelete: Cascade)

  @@id([user_id, perfil_id])
}

model permisos {
  id          BigInt           @id @default(autoincrement())
  nombre      String           @unique @db.VarChar(50)
  descripcion String?
  created_at  DateTime         @default(now()) @db.Timestamp(6)
  updated_at  DateTime         @db.Timestamp(6)

  perfil_permisos perfil_permisos[]
}

model perfil_permisos {
  id         BigInt   @id @default(autoincrement())
  perfil_id  BigInt
  permiso_id BigInt
  ver        Boolean  @default(false)
  crear      Boolean  @default(false)
  editar     Boolean  @default(false)
  eliminar   Boolean  @default(false)
  created_at DateTime @default(now()) @db.Timestamp(6)
  updated_at DateTime @db.Timestamp(6)

  perfiles perfiles @relation(fields: [perfil_id], references: [id], onDelete: Cascade)
  permisos permisos @relation(fields: [permiso_id], references: [id], onDelete: Cascade)
}
